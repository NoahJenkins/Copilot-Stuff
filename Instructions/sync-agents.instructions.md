# Sync Agent Instructions, Agents, and Skills from GitHub Copilot

Mirror all GitHub Copilot customizations — instructions, custom agents, and agent skills —
into the canonical files for Claude Code, Gemini CLI, and OpenAI Codex.

**Source locations (Copilot / source of truth):**
- `.github/copilot-instructions.md` — global instructions
- `.github/instructions/*.instructions.md` — path-scoped instructions
- `.github/agents/*.agent.md` — custom agent profiles
- `.github/skills/<name>/SKILL.md` — agent skills (open standard)

## Your Task

Execute the following steps **in order**, creating or overwriting files as needed.
Never delete `.github/copilot-instructions.md` or anything inside `.github/`.

---

### Step 1 — Read the source of truth

Read `.github/copilot-instructions.md` and store its full content.

If the file does not exist, stop and tell the user:
> "No `.github/copilot-instructions.md` found. Please create this file first — it is the source of truth for all AI agent instructions."

Also scan and store the contents of:

- **`.github/instructions/`** — any `*.instructions.md` files. For each, record the filename, `applyTo` frontmatter glob (if present), and body content.
- **`.github/agents/`** — any `*.agent.md` files. For each, record the full filename, the complete YAML frontmatter block (`name`, `description`, `model`, `tools`, `handoffs`, etc.), and the body prompt.
- **`.github/skills/`** — any subdirectory containing a `SKILL.md` file. For each skill, record the directory name, the complete `SKILL.md` frontmatter (`name`, `description`, `user-invokable`, `disable-model-invocation`, etc.), the body content, and note any additional bundled asset files (scripts, examples, references) present in that directory.

---

### Step 2 — Create directory scaffolding

```bash
# Claude Code
mkdir -p .claude/commands
mkdir -p .claude/agents
mkdir -p .claude/skills

# Gemini CLI (instructions only — no agents/skills concept in Gemini CLI)
mkdir -p .gemini

# Codex skills (open standard; Codex reads from .agents/skills/)
mkdir -p .agents/skills

# AGENTS.md goes at repo root (no subdirectory needed for Codex)
```

---

### Step 3 — Write `CLAUDE.md` (Claude Code)

Create or overwrite `CLAUDE.md` at the repo root with this structure:

```
<!--
  ╔══════════════════════════════════════════════════════════════╗
  ║  AUTO-SYNCED — DO NOT EDIT THIS FILE DIRECTLY               ║
  ║  Source of truth: .github/copilot-instructions.md           ║
  ║  To update: run /sync-agents.instructions in Claude Code     ║
  ╚══════════════════════════════════════════════════════════════╝
-->

# Claude Code Instructions

> **Source of truth:** [`.github/copilot-instructions.md`](.github/copilot-instructions.md)
>
> This file is automatically generated by the `/sync-agents.instructions` command.
> To propagate changes, update `.github/copilot-instructions.md` and re-run that command.

---

[INSERT FULL CONTENT OF .github/copilot-instructions.md HERE]
```

If there are path-specific `.github/instructions/*.instructions.md` files, also create
matching `.claude/instructions/` files in the same structure, each with a header:
```
<!-- Synced from .github/instructions/<filename>.instructions.md — do not edit directly -->
```
followed by the body content of the source file (strip the applyTo frontmatter — Claude Code
does not use it; include it as a plain markdown comment instead so context is preserved).

---

### Step 4 — Write `GEMINI.md` (Gemini CLI)

Create or overwrite `GEMINI.md` at the repo root.

Gemini CLI natively supports the `@path/to/file.md` import syntax, which causes it to
**dynamically load the referenced file at runtime** — meaning GEMINI.md will always reflect
the current state of `.github/copilot-instructions.md` without needing to re-run this command.

Write exactly this content (substituting any existing path-specific file imports below):

```markdown
<!--
  ╔══════════════════════════════════════════════════════════════╗
  ║  SOURCE OF TRUTH: .github/copilot-instructions.md           ║
  ║  This file uses Gemini CLI's native @import syntax so it    ║
  ║  always loads the latest copilot instructions at runtime.   ║
  ║  Run /sync-agents.instructions to update path-specific files.║
  ╚══════════════════════════════════════════════════════════════╝
-->

# Gemini CLI Instructions

> **Source of truth:** `.github/copilot-instructions.md`
> This file dynamically imports from Copilot's instruction file using Gemini's
> `@file` syntax. Any edits to `.github/copilot-instructions.md` are reflected
> here automatically — no manual sync required.

@.github/copilot-instructions.md
```

If there are `.github/instructions/*.instructions.md` files, append additional imports
after the main import, one per line in the format `@.github/instructions/<filename>.instructions.md`,
preceded by a comment noting what the file covers (extract from the applyTo value or filename).

If there are also subdirectory-specific instructions (files with an `applyTo` pointing to a
specific directory), create matching `GEMINI.md` files inside those directories using the same
`@` import syntax pointing back to the original `.github/instructions/` file.

---

### Step 5 — Write `AGENTS.md` (OpenAI Codex)

Create or overwrite `AGENTS.md` at the repo root with this structure:

```
<!--
  ╔══════════════════════════════════════════════════════════════╗
  ║  AUTO-SYNCED — DO NOT EDIT THIS FILE DIRECTLY               ║
  ║  Source of truth: .github/copilot-instructions.md           ║
  ║  To update: run /sync-agents.instructions in Claude Code     ║
  ╚══════════════════════════════════════════════════════════════╝
-->

# Codex Agent Instructions

> **Source of truth:** [`.github/copilot-instructions.md`](.github/copilot-instructions.md)
>
> This file is automatically generated by the `/sync-agents.instructions` command.
> To propagate changes, update `.github/copilot-instructions.md` and re-run that command.

---

[INSERT FULL CONTENT OF .github/copilot-instructions.md HERE]
```

For each `.github/instructions/*.instructions.md` file that has an `applyTo` targeting a
specific subdirectory path, create a corresponding `AGENTS.md` inside that subdirectory
with the same structure and a note indicating it was synced from that instructions file.

Codex reads one `AGENTS.md` per directory level and merges them top-down, so subdirectory
files will correctly scope their overrides.

---

### Step 6 — Sync custom agents

**Claude Code** (`.claude/agents/`)

Agent Skills is an open standard. VS Code explicitly supports both `.github/agents/*.agent.md`
(Copilot format) and `.claude/agents/*.md` (Claude format) interchangeably, so the files
are compatible with only minor differences to note:

- Copilot uses `.agent.md` extension; Claude Code uses plain `.md`
- Claude Code uses comma-separated `tools` strings in frontmatter; Copilot uses YAML arrays —
  both are accepted by VS Code, so preserve the Copilot array format, it will work in both

For each `.github/agents/<name>.agent.md` file found in Step 1:
1. Create `.claude/agents/<name>.md` (drop the `.agent` infix from the extension)
2. Write the full YAML frontmatter block verbatim, then add this line immediately after
   the opening `---` and before any existing fields:
   ```
   # AUTO-SYNCED from .github/agents/<name>.agent.md — do not edit directly
   # Source of truth: .github/agents/ | Re-sync: /sync-agents.instructions
   ```
   (as a YAML comment so it doesn't break frontmatter parsing)
3. Write the body prompt verbatim after the closing `---`

**OpenAI Codex** — Codex is a single-agent system; it has no sub-agent profile concept
equivalent to `.agent.md`. Skip agent syncing for Codex.

**Gemini CLI** — Gemini CLI has no sub-agent profile concept. Skip agent syncing for Gemini.

---

### Step 7 — Sync agent skills

Agent Skills use an **open standard** (`SKILL.md` with YAML frontmatter). The format is
identical across Copilot, Claude Code, and Codex — only the storage path differs:

| Tool | Skills path |
|---|---|
| GitHub Copilot (source) | `.github/skills/<skill-name>/SKILL.md` |
| Claude Code | `.claude/skills/<skill-name>/SKILL.md` |
| OpenAI Codex | `.agents/skills/<skill-name>/SKILL.md` |
| Gemini CLI | ❌ No skills concept |

For each `.github/skills/<skill-name>/` directory found in Step 1:

**Claude Code:**
1. Create `.claude/skills/<skill-name>/` directory
2. Write `.claude/skills/<skill-name>/SKILL.md` with the **full contents** of the source
   `SKILL.md` verbatim — the format is identical, no translation needed
3. Add a YAML comment on the first line inside the frontmatter block:
   ```
   # AUTO-SYNCED from .github/skills/<skill-name>/SKILL.md — do not edit directly
   ```
4. If any bundled asset files (scripts, examples, reference docs) exist alongside the source
   `SKILL.md`, copy them into the `.claude/skills/<skill-name>/` directory as-is.
   These files are referenced by the SKILL.md body and must travel with it.

**OpenAI Codex:**
1. Create `.agents/skills/<skill-name>/` directory
2. Write `.agents/skills/<skill-name>/SKILL.md` with the same full verbatim contents
   plus the same YAML comment noting the source
3. Copy any bundled asset files into `.agents/skills/<skill-name>/` as-is

**Important — `name` field constraint:** The `name` field in the SKILL.md frontmatter
**must exactly match the parent directory name**. Since you are preserving the directory
name from `.github/skills/<skill-name>/`, this will naturally be correct. Do not rename
the directory or alter the `name` field.

**Gemini CLI:** No skills concept exists in Gemini CLI. Skip skill syncing for Gemini.
If `.github/skills/` contains skills, append a note to `GEMINI.md` after the main import:
```markdown
<!-- NOTE: Agent Skills are not supported by Gemini CLI. -->
<!-- Skills available in this repo: <comma-separated skill names> -->
<!-- See .github/skills/ for skill definitions usable by Copilot, Claude, and Codex. -->
```

---

### Step 8 — Verify and report

After writing all files, list every file created or updated and confirm:

```
✅ Sync complete. Files written:

INSTRUCTIONS
  - CLAUDE.md                                  (Claude Code root instructions)
  - .claude/instructions/<files>               (if path-specific files existed)
  - GEMINI.md                                  (Gemini CLI — live @import link)
  - .gemini/<subdir>/GEMINI.md                 (if path-specific subdirs existed)
  - AGENTS.md                                  (OpenAI Codex root instructions)
  - <subdir>/AGENTS.md                         (if path-specific subdirs existed)

CUSTOM AGENTS
  - .claude/agents/<name>.md                   (one per .github/agents/*.agent.md)
  (Codex and Gemini have no sub-agent profile concept — skipped)

SKILLS
  - .claude/skills/<name>/SKILL.md             (one per .github/skills/<name>/)
  - .agents/skills/<name>/SKILL.md             (one per .github/skills/<name>/)
  (Gemini CLI has no skills concept — skipped, noted in GEMINI.md)

Source of truth: .github/ (copilot-instructions.md, agents/, skills/, instructions/)
To keep all agents in sync, run /sync-agents.instructions after any Copilot update.
```

---

## Sync Coverage Reference

### Instructions

| Agent | Primary File | Format | Notes |
|---|---|---|---|
| GitHub Copilot | `.github/copilot-instructions.md` | Markdown | **Source of truth** |
| Claude Code | `CLAUDE.md` | Markdown | Copied at sync time |
| Gemini CLI | `GEMINI.md` | Markdown + `@imports` | Live import — no re-sync needed |
| OpenAI Codex | `AGENTS.md` | Markdown | Copied at sync time |

### Custom Agents

| Agent | Path | Notes |
|---|---|---|
| GitHub Copilot | `.github/agents/*.agent.md` | **Source of truth** |
| Claude Code | `.claude/agents/*.md` | Copied at sync; format-compatible |
| Gemini CLI | ❌ Not supported | No sub-agent profile concept |
| OpenAI Codex | ❌ Not supported | Single-agent system |

### Skills (Open Standard)

| Agent | Path | Notes |
|---|---|---|
| GitHub Copilot | `.github/skills/<n>/SKILL.md` | **Source of truth** |
| Claude Code | `.claude/skills/<n>/SKILL.md` | Verbatim copy — format identical |
| OpenAI Codex | `.agents/skills/<n>/SKILL.md` | Verbatim copy — format identical |
| Gemini CLI | ❌ Not supported | Noted as comment in GEMINI.md |

---

## Docs references

- **GitHub Copilot** custom instructions: https://docs.github.com/copilot/customizing-copilot/adding-custom-instructions-for-github-copilot
- **GitHub Copilot** custom agents: https://docs.github.com/en/copilot/how-tos/use-copilot-agents/coding-agent/create-custom-agents
- **GitHub Copilot** agent skills: https://docs.github.com/en/copilot/how-tos/use-copilot-agents/coding-agent/create-skills
- **Claude Code** memory/instructions: https://docs.anthropic.com/en/docs/claude-code/memory
- **Claude Code** sub-agents: https://docs.anthropic.com/en/docs/claude-code/sub-agents
- **Gemini CLI** GEMINI.md + `@import`: https://google-gemini.github.io/gemini-cli/docs/cli/gemini-md.html
- **OpenAI Codex** AGENTS.md: https://developers.openai.com/codex/guides/agents-md/
- **OpenAI Codex** skills: https://developers.openai.com/codex/skills/
- **VS Code** custom agents (cross-tool format compatibility): https://code.visualstudio.com/docs/copilot/customization/custom-agents